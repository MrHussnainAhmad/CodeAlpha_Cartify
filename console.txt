C:\Users\Alsaba\OneDrive\Documents\shop2>  npm run dev

> shop@0.1.0 dev
> next dev --turbopack

 ⚠ Warning: Found multiple lockfiles. Selecting C:\Users\Alsaba\package-lock.json.
   Consider removing the lockfiles at:
   * C:\Users\Alsaba\OneDrive\Documents\shop2\package-lock.json

   ▲ Next.js 15.4.5 (Turbopack)
   - Local:        http://localhost:3000
   - Network:      http://192.168.1.19:3000
   - Environments: .env.local, .env

 ✓ Starting...
 ○ Compiling middleware ...
 ✓ Compiled middleware in 1517ms
 ✓ Ready in 5.9s
 ○ Compiling / ...
 ✓ Compiled / in 15.4s
Fetching web data from /api/webdata...
 ○ Compiling /api/categories ...
Attempting to connect to database...
 ✓ Compiled /api/categories in 1318ms
Attempting to connect to database...
Database connected successfully!
Database connected successfully!
 GET /api/webdata 200 in 2113ms
Web data API response status: 200
Web data API JSON response: {
  socialLinks: {
    facebook: '',
    twitter: '',
    instagram: '',
    linkedin: '',
    youtube: ''
  },
  contactInfo: { visitUs: '', callUs: '', emailUs: '', workingHours: '' },
  sectionSettings: { shopByBrandsVisible: true },
  _id: '690d2b0a72e814ea371318c3',
  aboutUs: 'Default About Us content.',
  terms: 'Default Terms and Conditions content.',
  privacy: 'Default Privacy Policy content.',
  faqs: 'Default FAQs content.',
  help: 'Default Help content.',
  logo: '/Logo.png',
  storeName: 'My Awesome Store',
  createdAt: '2025-11-06T23:11:06.043Z',
  updatedAt: '2025-11-06T23:11:06.043Z',
  __v: 0
}
 GET /api/categories 200 in 1441ms
Attempting to connect to database...
Database connected successfully!
Logo src: /Logo.png
Logo src: /Logo.png
 ○ Compiling /api/products ...
Using existing database connection
 GET /api/brands 200 in 672ms
ShopbyBrands image src: https://res.cloudinary.com/dwca4jeyw/image/upload/v1762508569/next-ecommerce/p11yipfxn67kap13mskm.jpg
Using existing database connection
 GET /api/products?isFeatured=true 200 in 1921ms
Using existing database connection
=== GET /api/banners/simple START ===
Using existing database connection
 GET /api/categories 304 in 1156ms
Found 0 banners
 GET /api/banners/simple 200 in 4526ms
 GET / 200 in 26894ms
 ✓ Compiled /api/products in 6.6s
Using existing database connection
 GET /api/user/profile 404 in 1007ms
 ○ Compiling /cart ...
 ✓ Compiled /cart in 1850ms
 GET /cart 200 in 2114ms
 ○ Compiling /api/addresses ...
 ✓ Compiled /api/addresses in 2.2s
Using existing database connection
 GET /api/addresses?email=ranawaleed1972%40gmail.com 200 in 2536ms
Using existing database connection
 GET /api/addresses?email=ranawaleed1972%40gmail.com 200 in 341ms
 ○ Compiling /checkout ...
 ✓ Compiled /checkout in 3.8s
Fetching web data from /api/webdata...
Using existing database connection
 GET /api/webdata 200 in 357ms
Web data API response status: 200
Web data API JSON response: {
  socialLinks: {
    facebook: '',
    twitter: '',
    instagram: '',
    linkedin: '',
    youtube: ''
  },
  contactInfo: { visitUs: '', callUs: '', emailUs: '', workingHours: '' },
  sectionSettings: { shopByBrandsVisible: true },
  _id: '690d2b0a72e814ea371318c3',
  aboutUs: 'Default About Us content.',
  terms: 'Default Terms and Conditions content.',
  privacy: 'Default Privacy Policy content.',
  faqs: 'Default FAQs content.',
  help: 'Default Help content.',
  logo: '/Logo.png',
  storeName: 'My Awesome Store',
  createdAt: '2025-11-06T23:11:06.043Z',
  updatedAt: '2025-11-06T23:11:06.043Z',
  __v: 0
}
Logo src: /Logo.png
Logo src: /Logo.png
 GET /checkout 200 in 4899ms
Using existing database connection
 GET /api/categories 304 in 1080ms
 ○ Compiling /api/stripe/create-payment-intent ...
Using existing database connection
 GET /api/user/profile 404 in 977ms
 ✓ Compiled /api/stripe/create-payment-intent in 5s
 POST /api/stripe/create-payment-intent 200 in 7132ms
 ✓ Compiled /api/addresses/email in 342ms
=== GET /api/addresses/email START ===
Looking for addresses for email: muhammadwaleedkhalid778@gmail.com
Using existing database connection
Found user profile: {
  _id: new ObjectId('690dc3c3aaf6dccab075522f'),
  email: 'muhammadwaleedkhalid778@gmail.com',
  addressesCount: 0
}
=== GET /api/addresses/email SUCCESS ===
 GET /api/addresses/email?email=muhammadwaleedkhalid778%40gmail.com 200 in 579ms
=== POST /api/addresses/email START ===
Connecting to database...
Using existing database connection
Database connected successfully
Parsing request body...
Request body: {
  "name": "Waleed Khalid",
  "email": "muhammadwaleedkhalid778@gmail.com",
  "streetAddress": "Village 72/4-R, Tehsil Haroonabad, District Bahawalnagar",
  "apartment": "1",
  "city": "Haroonabad",
  "state": "SK",
  "postalCode": "A1A 1A1",
  "country": "CA",
  "phone": "",
  "isDefault": false
}
Looking for user with email: muhammadwaleedkhalid778@gmail.com
=== ADDING ADDRESS ===
Current user before adding address: {
  _id: new ObjectId('690dc3c3aaf6dccab075522f'),
  email: 'muhammadwaleedkhalid778@gmail.com',
  addressesCount: 0
}
New address to add: {
  "name": "Waleed Khalid",
  "streetAddress": "Village 72/4-R, Tehsil Haroonabad, District Bahawalnagar",
  "apartment": "1",
  "city": "Haroonabad",
  "state": "SK",
  "postalCode": "A1A 1A1",
  "country": "CA",
  "phone": "",
  "isDefault": false,
  "email": "muhammadwaleedkhalid778@gmail.com"
}
Addresses count before push: 0
Addresses count after push: 1
Saving user profile...
=== POST /api/addresses/email ERROR ===
Error type: ValidationError
Error message: UserProfile validation failed: addresses.0.phone: Path `phone` is required.
Error stack: ValidationError: UserProfile validation failed: addresses.0.phone: Path `phone` is required.
    at Document.invalidate (C:\Users\Alsaba\OneDrive\Documents\shop2\node_modules\mongoose\lib\document.js:3358:32)
    at Subdocument.invalidate (C:\Users\Alsaba\OneDrive\Documents\shop2\node_modules\mongoose\lib\types\subdocument.js:229:12)
    at C:\Users\Alsaba\OneDrive\Documents\shop2\node_modules\mongoose\lib\document.js:3119:17
    at C:\Users\Alsaba\OneDrive\Documents\shop2\node_modules\mongoose\lib\schemaType.js:1410:9
    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)
Validation errors: {
  'addresses.0.phone': [ValidatorError: Path `phone` is required.] {
    properties: {
      validator: [Function (anonymous)],
      message: 'Path `phone` is required.',
      type: 'required',
      path: 'phone',
      fullPath: undefined,
      value: ''
    },
    kind: 'required',
    path: 'phone',
    value: '',
    reason: undefined,
    formatMessage: [Function: formatMessage]
  }
}
 POST /api/addresses/email 500 in 409ms
 ✓ Compiled /api/orders/process-payment in 248ms
Using existing database connection
 POST /api/orders/process-payment 400 in 253ms
 ○ Compiling /checkout/success ...
 ✓ Compiled /checkout/success in 3.4s
Fetching web data from /api/webdata...
Using existing database connection
 GET /api/webdata 200 in 362ms
Web data API response status: 200
Web data API JSON response: {
  socialLinks: {
    facebook: '',
    twitter: '',
    instagram: '',
    linkedin: '',
    youtube: ''
  },
  contactInfo: { visitUs: '', callUs: '', emailUs: '', workingHours: '' },
  sectionSettings: { shopByBrandsVisible: true },
  _id: '690d2b0a72e814ea371318c3',
  aboutUs: 'Default About Us content.',
  terms: 'Default Terms and Conditions content.',
  privacy: 'Default Privacy Policy content.',
  faqs: 'Default FAQs content.',
  help: 'Default Help content.',
  logo: '/Logo.png',
  storeName: 'My Awesome Store',
  createdAt: '2025-11-06T23:11:06.043Z',
  updatedAt: '2025-11-06T23:11:06.043Z',
  __v: 0
}
Logo src: /Logo.png
Logo src: /Logo.png
 GET /checkout/success?payment_intent=pi_3SQnxqQo62DjYr3z0BOphbWV 200 in 4481ms
Using existing database connection
 GET /api/categories 304 in 585ms
Using existing database connection
 GET /api/user/profile 404 in 499ms
 ○ Compiling /api/orders ...
 ✓ Compiled /api/orders in 1182ms
Using existing database connection
 GET /api/orders 200 in 894ms
 ○ Compiling /admin/orders ...
 ✓ Compiled /admin/orders in 3.5s
Fetching web data from /api/webdata...
Fetching web data from /api/webdata...
Using existing database connection
 GET /api/webdata 200 in 1344ms
Web data API response status: 200
Web data API JSON response: {
  socialLinks: {
    facebook: '',
    twitter: '',
    instagram: '',
    linkedin: '',
    youtube: ''
  },
  contactInfo: { visitUs: '', callUs: '', emailUs: '', workingHours: '' },
  sectionSettings: { shopByBrandsVisible: true },
  _id: '690d2b0a72e814ea371318c3',
  aboutUs: 'Default About Us content.',
  terms: 'Default Terms and Conditions content.',
  privacy: 'Default Privacy Policy content.',
  faqs: 'Default FAQs content.',
  help: 'Default Help content.',
  logo: '/Logo.png',
  storeName: 'My Awesome Store',
  createdAt: '2025-11-06T23:11:06.043Z',
  updatedAt: '2025-11-06T23:11:06.043Z',
  __v: 0
}
Web data API response status: 200
Web data API JSON response: {
  socialLinks: {
    facebook: '',
    twitter: '',
    instagram: '',
    linkedin: '',
    youtube: ''
  },
  contactInfo: { visitUs: '', callUs: '', emailUs: '', workingHours: '' },
  sectionSettings: { shopByBrandsVisible: true },
  _id: '690d2b0a72e814ea371318c3',
  aboutUs: 'Default About Us content.',
  terms: 'Default Terms and Conditions content.',
  privacy: 'Default Privacy Policy content.',
  faqs: 'Default FAQs content.',
  help: 'Default Help content.',
  logo: '/Logo.png',
  storeName: 'My Awesome Store',
  createdAt: '2025-11-06T23:11:06.043Z',
  updatedAt: '2025-11-06T23:11:06.043Z',
  __v: 0
}
Logo src: /Logo.png
 GET /admin/orders 200 in 6366ms
Using existing database connection
 GET /api/orders 200 in 420ms
